(globalThis.__LOADABLE_LOADED_CHUNKS__=globalThis.__LOADABLE_LOADED_CHUNKS__||[]).push([[7136],{437769:e=>{e.exports={"toggle-link-arrow-wrap":"toggle-link-arrow-wrap__09f24__pe7lY","inactive-arrow":"inactive-arrow__09f24__bL7do","active-arrow":"active-arrow__09f24__3iMIz",title:"title__09f24__WVwX3",content:"content__09f24__B0HTe"}},844115:e=>{e.exports={"toggle-link-arrow-wrap":"toggle-link-arrow-wrap__09f24__RvSwO","inactive-arrow":"inactive-arrow__09f24__AlnEF","active-arrow":"active-arrow__09f24__QgBIU"}},862919:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var s=n(292551),i=n(87363),r=n(750179),o=n(341957),a=n(647145),l=n(263286),u=n(959659),d=n(387137),c=n(844115),g=n.n(c),p=n(481040);const v=({active:e})=>(0,p.jsx)(d.Dr,{className:g()["toggle-link-arrow-wrap"]},(0,p.jsx)(d.Dr,{className:e?g()["active-arrow"]:g()["inactive-arrow"],role:"presentation"}));var h=n(437769),x=n.n(h);const f=({title:e,onTitleClick:t,expanded:n,children:s})=>(0,p.jsx)(u.W2,null,(0,p.jsx)(r.X6,{level:4},(0,p.jsx)(o.zx,{type:"link",onClick:t,className:x().title},(0,p.jsx)(v,{active:n}),(0,p.jsx)(u.W2,{display:"inline"},(0,p.jsx)(r.xv,{bold:!0,inline:!0,color:"inherit"},e)))),(0,p.jsx)(u.W2,{className:x().content},n?s:null));class w extends i.Component{constructor(e){var t,n,s;super(e),s=()=>{this.setState((({expanded:e})=>({expanded:!e})))},(n="toggle")in(t=this)?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,this.state={expanded:e.forceExpanded}}UNSAFE_componentWillReceiveProps(e){this.props.forceExpanded!==e.forceExpanded&&this.setState({expanded:e.forceExpanded})}render(){return(0,p.jsx)(f,{expanded:this.state.expanded,onTitleClick:this.toggle,title:this.props.title},this.props.children)}}const m=w,y=({locale:e})=>{const[t,n]=(0,i.useState)(!1),d=`https://biz.yelp.com/support/review_solicitation?hl=${e}`;return(0,p.jsx)(u.W2,null,(0,p.jsx)(u.W2,{marginBottom:1},(0,p.jsx)(r.X6,{level:5},(0,l.ag)("General Guidelines"))),(0,p.jsx)(r.xv,{paragraph:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("People come to Yelp to connect with great local businesses. We know that people won’t always agree, but we expect everyone on the site to treat one another and the platform with honesty and respect. We’ve put together these general guidelines to help set the tone for discourse on the site—just in case. Please also read the additional guidelines below for specific types of content that you might contribute to the site.",{}).toString()})),(0,p.jsx)(a.aV,{useLegacyMargin:!0,type:"round"},(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Relevance</0><1>: Please make sure your contributions are appropriate to the forum. For example, reviews aren’t the place for rants about political ideologies, a business’s employment practices, extraordinary circumstances, or other matters that don’t address the core of the consumer experience.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Inappropriate content</0><1>: Colorful language and imagery are fine, but there’s no place for threats, harassment, lewdness, hate speech, or other displays of bigotry.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Conflicts of interest</0><1>: Your contributions to Yelp should be unbiased and objective. For example, you shouldn’t write reviews of your own business or employer, your friends’ or relatives’ business, your peers or competitors in your industry, or businesses in your networking group. Businesses <2>should never ask customers to write reviews</2>.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0}),(0,p.jsx)(r.rU,{href:d})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Privacy</0><1>: Don’t publicize people’s private information. For instance, please don’t post close-up photos or videos of other patrons without their permission, and don’t post other people’s full names unless you’re referring to someone who is commonly referred to by their full name.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Promotional content</0><1>: Don’t post promotional material unless it’s in connection with a Yelp advertising product and through a Business Account. Let’s keep the site useful for consumers and not overrun with commercial noise from every user.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Intellectual property</0><1>: Don’t swipe content from other sites, users, or businesses. You’re a smart cookie, so write your own copy and share your own photos and videos.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]}))),(0,p.jsx)(u.W2,{marginBottom:1},(0,p.jsx)(r.X6,{level:5},(0,l.ag)("Additional Guidelines"))),(0,p.jsx)(r.xv,{paragraph:!0},(0,p.jsx)(o.zx,{type:"link",onClick:()=>{n((e=>!e))}},t?(0,l.ag)("Collapse All"):(0,l.ag)("Expand All"))),(0,p.jsx)(m,{forceExpanded:t,title:(0,l.ag)("Review Guidelines")},(0,p.jsx)(r.xv,{paragraph:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("The best reviews are personal, passionate, and reflect your consumer experience. They offer a rich narrative, a wealth of detail, and a helpful tip or two for other consumers. Here are some additional thoughts for conscientious reviewers:",{}).toString()})),(0,p.jsx)(a.aV,{useLegacyMargin:!0,type:"round"},(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Personal experience</0><1>: We want to hear about your firsthand experience, not what you heard from your partner or co-worker, or what you saw in the news. Tell your own story without resorting to broad generalizations and conclusory allegations.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Accuracy</0><1>: Make sure your review is factually correct. Feel free to air your opinions, but don’t exaggerate or misrepresent your experience. We don’t take sides when it comes to factual disputes, so we expect you to stand behind your review.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Demanding payment</0><1>: Writing a review should be informative and meant to help the broader Yelp community. You should not threaten to post or offer to remove a negative review as a way to extract payment from a business.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Review updates</0><1>: Review updates should reflect a new experience or interaction with the business. Don’t keep posting about the same old story you’ve already told. If you’d like to add new insight to an old experience, you can edit your review within 30 days of posting it.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})))),(0,p.jsx)(m,{forceExpanded:t,title:(0,l.ag)("Photo and Video Guidelines")},(0,p.jsx)(r.xv,{paragraph:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("Photos and videos should be broadly relevant to the business and reflect the typical consumer experience (e.g., what the business looks like, what the business offers, etc.). If you’re a business, show us what you offer and what makes your business unique. Here are some additional things to keep in mind:",{}).toString()})),(0,p.jsx)(a.aV,{useLegacyMargin:!0,type:"round"},(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Keep it relevant to everyone</0><1>: We may remove a photo or video that showcases a unique personal experience that isn’t relevant to other people (e.g., a receipt or email exchange with a business) from the photo gallery for the business, but it may appear alongside your review if you write one about the business.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Keep it clean</0><1>: We don’t want imagery of violence, drug use, nudity, near nudity, or suggestive acts—even if those images are an accurate representation of the business’s services or products.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Keep it friendly</0><1>: Don’t use your photos or videos to attack or disparage others. A picture is worth 1,000 words, so it’s best to pick those words carefully and make your point in a review, direct message, or review response.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})))),(0,p.jsx)(m,{forceExpanded:t,title:(0,l.ag)("Community Guidelines")},(0,p.jsx)(r.xv,{paragraph:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("Don’t be shy. Use your account profile to let people know who you are and what makes you tick. Your peers want to read reviews from people they know and trust (not those with profiles that are empty or laced with inappropriate content).",{}).toString()})),(0,p.jsx)(a.aV,{useLegacyMargin:!0,type:"round"},(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>User Profiles</0><1>: Since user trust and transparency are important to us, anonymous users who are disruptive to the community will be dealt with more sternly than those who stand behind their words. We encourage users to tell people a little something about themselves, but ask that you keep it relevant and don’t attack competitors, reviewers, or Yelp. Avoid seeding your profile with keywords, special offers, or promotions—we’ll remove those if we see them.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Consumer Messaging</0><1>: Yelp has a handy messaging feature to keep you connected with your fellow Yelpers. Please don’t use this feature to harass other users or send other inappropriate content, and remember, consumer accounts are for personal, non-commercial use only.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Business Messaging</0><1>: Businesses should message reviewers using their free Business Account. Direct messaging is often the best way to resolve a dispute with an unhappy customer, but you can also address issues publicly by posting a public comment in response to a review. As with consumers, we ask that business representatives upload a clear photo of themselves to help personalize their messaging. Hopefully it goes without saying, but don’t use direct messages or public comments to launch personal attacks or offer an incentive to change a review.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})),(0,p.jsx)(r.xv,{inline:!0},(0,p.jsx)(s.Trans,{id:(0,l.ag)("<0>Ask the Community</0><1>: Being able to ask and answer community questions about a business is extremely valuable, but as they say, with great power comes great responsibility. Stick to questions that are also relevant to others, don’t ask loaded questions or make presumptions, and keep the tone civil and non-argumentative. If you really don’t have anything meaningful to add, best not to say anything at all. Clear questions with enough context and details will get more focused answers and meaningful conversation. For example, topics like “what is the best pizza place in town” are best discussed in Talk.</1>",{}).toString(),components:[(0,p.jsx)(r.xv,{bold:!0,inline:!0}),(0,p.jsx)(r.xv,{inline:!0})]})))))}},466918:(e,t,n)=>{"use strict";n.d(t,{gj:()=>y,qL:()=>C,QY:()=>oe,$q:()=>k,pq:()=>re,RW:()=>E,wW:()=>j,_L:()=>T,Uc:()=>We,j7:()=>Ae,I3:()=>R,Km:()=>_,Bk:()=>ce,lJ:()=>xe,K3:()=>Re,hx:()=>_e,ZK:()=>U});var s=n(87363),i=n(744635),r=n(537887),o=n(785645),a=n(263286),l=n(959659),u=n(750179),d=n(49115),c=n(686835),g=n(66758),p=n.n(g),v=n(341957),h=n(571117),x=n.n(h),f=n(862919),w=n(108836),m=n(481040);const y=({onClose:e,locale:t})=>(0,m.jsx)(w.Z,{size:"medium",title:(0,a.ag)("Content Guidelines"),onClose:e},(0,m.jsx)(l.W2,{style:{maxHeight:500},borderTop:!0,overflow:"scroll",paddingTop:2,paddingRight:1,textAlign:"left"},(0,m.jsx)(f.Z,{locale:t})));var b=n(949094);const E={DRAFTING:"drafting",AUTHENTICATING:"authenticating",UPLOADING_PHOTOS:"uploading_photos",POSTING_REVIEW:"posting_review",ERROR:"error",POSTED:"posted"},j={NONE:"none",USER_INPUT:"user_input",IN_PROGRESS:"in_progress",SAVED:"success",FAILURE:"failure"},T={EDITING:"editing",NEW_REVIEW:"new_review",COMPLETING_DRAFT:"completing_draft",UPDATING:"updating"},S=(e,t)=>b.ou.fromSeconds(e).diffNow().negate()<b.nL.fromObject({days:t}),R=e=>S(e,30),_=({queryReviewId:e,business:t,loggedInUser:n})=>{var s;const[i]=((null==n||null===(s=n.reviews)||void 0===s?void 0:s.edges)||[]).map((e=>e.node));return i&&S(i.timeCreatedTimestamp,1)||i&&i.encid===e&&R(i.timeCreatedTimestamp)?T.EDITING:null!=t&&t.reviewDraftForLoggedInUser?T.COMPLETING_DRAFT:i?T.UPDATING:T.NEW_REVIEW},I=(e,t="error",n)=>{window&&window.Bugsnag&&window.Bugsnag.notifyException(e,n??e.name,{},t)};var P=n(301727);const k=5e3,C=new Set(["fr_FR"]),D=o.ZP`
    query GetShowEditorInReviewFeedData($bizEncId: String!) {
        business(encid: $bizEncId) {
            consumerAlert {
                isHarsh
                alertType
            }
            categoryGroups {
                isRFN
            }
        }
        loggedInUser {
            encid
            reviews(first: 1, businessEncId: $bizEncId) {
                edges {
                    node {
                        encid
                    }
                }
            }
            hasUnconfirmedReviewForBusiness(businessEncid: $bizEncId)
        }
    }
`,U=({businessEncid:e,locale:t})=>{var n,s,r,o,a,l,u,d,c,g;const{data:v,loading:h,error:x}=(0,i.aM)(D,{variables:{bizEncId:e}});if(C.has(t))return{loading:!1,showEditor:!1};if(x)return I(p()(x)),{loading:!1,showEditor:!1};if(h||!v)return{loading:!0,showEditor:!1};const f=(0,P.CB)(null==v||null===(n=v.business)||void 0===n||null===(s=n.consumerAlert)||void 0===s?void 0:s.alertType),w=null==v||null===(r=v.business)||void 0===r||null===(o=r.consumerAlert)||void 0===o?void 0:o.isHarsh,m=Boolean(null==v||null===(a=v.loggedInUser)||void 0===a?void 0:a.hasUnconfirmedReviewForBusiness),[y]=((null==v||null===(l=v.loggedInUser)||void 0===l||null===(u=l.reviews)||void 0===u?void 0:u.edges)||[]).map((e=>e.node)),b=Boolean(!(null!==(d=v.loggedInUser)&&void 0!==d&&d.encid));return{loading:!1,showEditor:!f&&!w&&(b||!m&&!y)&&(null==v||null===(c=v.business)||void 0===c||null===(g=c.categoryGroups)||void 0===g?void 0:g.isRFN)}};var A=n(301720),N=n(242202),O=n(645587),W=n(388012),L=n(416206),F=n(422698),G=n(284015),M=n(151076),z=n(584122),B=n(712759);const $=s.useLayoutEffect;const q=function(e){var t=(0,s.useRef)(e);return $((function(){t.current=e})),t};var H=function(e,t){"function"!=typeof e?e.current=t:e(t)};const V=function(e,t){var n=(0,s.useRef)();return(0,s.useCallback)((function(s){e.current=s,n.current&&H(n.current,null),n.current=t,t&&H(t,s)}),[t])};var Y={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},Z=function(e){Object.keys(Y).forEach((function(t){e.style.setProperty(t,Y[t],"important")}))},K=null;var X=function(){},J=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],Q=!!document.documentElement.currentStyle,ee=function(e,t){var n=e.cacheMeasurements,i=e.maxRows,r=e.minRows,o=e.onChange,a=void 0===o?X:o,l=e.onHeightChange,u=void 0===l?X:l,d=(0,B.Z)(e,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]);var c,g=void 0!==d.value,p=(0,s.useRef)(null),v=V(p,t),h=(0,s.useRef)(0),x=(0,s.useRef)(),f=function(){var e=p.current,t=n&&x.current?x.current:function(e){var t=window.getComputedStyle(e);if(null===t)return null;var n,s=(n=t,J.reduce((function(e,t){return e[t]=n[t],e}),{})),i=s.boxSizing;return""===i?null:(Q&&"border-box"===i&&(s.width=parseFloat(s.width)+parseFloat(s.borderRightWidth)+parseFloat(s.borderLeftWidth)+parseFloat(s.paddingRight)+parseFloat(s.paddingLeft)+"px"),{sizingStyle:s,paddingSize:parseFloat(s.paddingBottom)+parseFloat(s.paddingTop),borderSize:parseFloat(s.borderBottomWidth)+parseFloat(s.borderTopWidth)})}(e);if(t){x.current=t;var s=function(e,t,n,s){void 0===n&&(n=1),void 0===s&&(s=1/0),K||((K=document.createElement("textarea")).setAttribute("tabindex","-1"),K.setAttribute("aria-hidden","true"),Z(K)),null===K.parentNode&&document.body.appendChild(K);var i=e.paddingSize,r=e.borderSize,o=e.sizingStyle,a=o.boxSizing;Object.keys(o).forEach((function(e){var t=e;K.style[t]=o[t]})),Z(K),K.value=t;var l=function(e,t){var n=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?n+t.borderSize:n-t.paddingSize}(K,e);K.value="x";var u=K.scrollHeight-i,d=u*n;"border-box"===a&&(d=d+i+r),l=Math.max(d,l);var c=u*s;return"border-box"===a&&(c=c+i+r),[l=Math.min(c,l),u]}(t,e.value||e.placeholder||"x",r,i),o=s[0],a=s[1];h.current!==o&&(h.current=o,e.style.setProperty("height",o+"px","important"),u(o,{rowHeight:a}))}};return(0,s.useLayoutEffect)(f),c=q(f),(0,s.useLayoutEffect)((function(){var e=function(e){c.current(e)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),(0,s.createElement)("textarea",(0,z.Z)({},d,{onChange:function(e){g||f(),a(e)},ref:v}))};const te=(0,s.forwardRef)(ee);var ne=n(74423),se=n(517521),ie=n(457715);const re=({prompt:e})=>(0,ne.useTransition)(e?[e]:[],{from:{opacity:0,transform:"translateY(100%)"},enter:{opacity:1,transform:"translateY(0%)"},leage:{opacity:0,transform:"translateY(100%)"}})(((e,t)=>(0,m.jsx)(ne.animated.div,{style:e},(0,m.jsx)(u.xv,{css:(0,m.css)("color:",M.J.core.grayscaleBlackDark.get(),";b{color:",(0,ie.h)(t.boldColor,!0),";}")},(0,m.jsx)(se.Z,null,t.text))))),oe=({errorText:e})=>(0,ne.useTransition)(e?[e]:[],{from:{opacity:0,transform:"translateY(100%)"},enter:{opacity:1,transform:"translateY(0%)"},leage:{opacity:0,transform:"translateY(100%)"}})(((e,t)=>(0,m.jsx)(ne.animated.div,{style:e},(0,m.jsx)(u.xv,{color:"red"},t))));var ae=n(361270),le=n(739641);const ue=o.ZP`
    query getWarPromptTriggers($businessEncid: String!) {
        business(encid: $businessEncid) {
            warMotivationalPromptTriggers {
                draftLengthThresholdCharacters
                idleMilliseconds
                minimumCharacterInterval
            }
        }
    }
`,de=o.ZP`
    query getWarMotivationalPrompt($businessEncid: String!, $draftText: String, $rating: Int, $seenPrompts: [String!]) {
        business(encid: $businessEncid) {
            warMotivationalPrompt(draftText: $draftText, rating: $rating, seenPrompts: $seenPrompts) {
                alias
                boldColor
                text
            }
        }
    }
`,ce=({text:e,rating:t,businessEncid:n})=>{const[r,o]=(0,s.useState)(-1),[a,l]=(0,s.useState)(t),[u,d]=(0,s.useState)(0),[c,g]=(0,s.useState)((0,le.l4)()),[v,h]=(0,s.useState)(null),{data:x,error:f}=(0,i.aM)(ue,{variables:{businessEncid:n}});let w=null,m=-1,y=-1;if(!f&&x){var b;const e=null==x||null===(b=x.business)||void 0===b?void 0:b.warMotivationalPromptTriggers;w=null==e?void 0:e.draftLengthThresholdCharacters,e&&e.idleMilliseconds&&(m=e.idleMilliseconds),e&&e.minimumCharacterInterval&&(y=e.minimumCharacterInterval)}const E=Boolean(w),j=m>=0&&y>=0,[T,{loading:S,error:R,networkStatus:_}]=(0,i.td)(de,{onCompleted:e=>{if(!R&&e){var t;const n=null==e||null===(t=e.business)||void 0===t?void 0:t.warMotivationalPrompt;(!n&&v||n&&!v||n&&v&&n.alias!==v.alias)&&(n&&g(c.add(n.alias)),h(n))}}}),P=(0,s.useCallback)((s=>{o(e.length),l(s||t),T({variables:{businessEncid:n,draftText:e,rating:s||t,seenPrompts:Array.from(c)}})}),[T,o,l,n,e,t,c]);(0,s.useEffect)((()=>{R&&I(p()(R),"warning","WarPromptError")}),[R]),(0,s.useEffect)((()=>{f&&I(p()(f),"warning","WarPromptError")}),[f]);const[k]=(0,ae.Z)((e=>{e>=y&&(d(0),P())}),m);return(0,s.useEffect)((()=>{k(u)}),[u,k]),(0,s.useEffect)((()=>{P()}),[]),(0,s.useEffect)((()=>{let t=!1;if(E&&r>=0){const n=e.length;t=w.some((e=>n>=e&&r<e||n<e&&r>=e))}!S&&t&&P()}),[e]),{prompt:v,onRatingChange:e=>{if(j){const t=new Map([[0,"empty"],[1,"negative"],[2,"negative"],[3,"neutral"],[4,"positive"],[5,"positive"]]);t.get(e)!==t.get(a)&&P(e)}},onKeystroke:()=>{j&&7===_&&d(u+1)}}},ge=o.ZP`
    query getWarInlineEditorInputData($businessEncid: String!) {
        business(encid: $businessEncid) {
            reviewGhostText
        }
    }
`,pe=({businessEncid:e,saveDraftStatus:t,text:n,rating:r,inputError:o,onTextChange:d,onRatingChange:g})=>{var v;const{data:h,error:x}=(0,i.aM)(ge,{variables:{businessEncid:e}}),{prompt:f,onRatingChange:w,onKeystroke:y}=ce({text:n,rating:r,businessEncid:e}),b=(0,s.useRef)(null);(0,s.useEffect)((()=>{x&&I(p()(x))}),[x]);let E="";return t===j.USER_INPUT||t===j.IN_PROGRESS?E=(0,a.ag)("Saving…"):t===j.SAVED&&(E=(0,a.ag)("All changes saved")),(0,m.jsx)(l.W2,{onClick:()=>{b.current&&b.current.focus()},role:"presentation"},(0,m.jsx)(c.gg,{marginBottom:2,marginBottomSm:1,layoutStack:"small",verticalAlign:"baseline"},(0,m.jsx)(c.ey,{fill:!0},(0,m.jsx)(L.SH,{defaultRating:r,onChange:e=>{w(e),g(e)}})),(0,m.jsx)(c.ey,{nowrap:!0},(0,m.jsx)(u.xv,{color:"inherit"},E))),(0,m.jsx)(te,{placeholder:null==h||null===(v=h.business)||void 0===v?void 0:v.reviewGhostText,value:n,onChange:e=>{y(),d(e.target.value)},spellCheck:!0,maxLength:k,ref:b,minRows:3,maxRows:20,css:(0,W.Z)([F.BW,(0,m.css)("font-size:16px;line-height:22px;border:0;outline:none;padding:0;resize:none;width:100%;::placeholder{color:",M.J.core.grayscaleGrayRegular.get(),";}")],"")}),(0,m.jsx)(l.W2,{paddingTop:1,css:(0,m.css)("background-color:white;min-height:",(0,G.r$)(3),"px;")},o?(0,m.jsx)(oe,{errorText:o}):f&&(0,m.jsx)(re,{prompt:f})))};var ve=n(349459),he=n(927207);const xe=({reviewRating:e,reviewText:t,isLoggedIn:n,onPostReviewRequest:i,onFinishPosting:r,onAuth:o,photoUpload:l})=>{const[u,d]=(0,s.useState)(E.DRAFTING),c=(0,he.D9)(u),[g,p]=(0,s.useState)(null),[v,h]=(0,s.useState)(null),f=(0,he.D9)(n),[w,m]=(0,s.useState)(!1),[y,b]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{c!==u&&u===E.POSTING_REVIEW&&(async()=>{const e=await i();e.success?(h(e.reviewEncid),d(E.POSTED)):(p(e.errorMessage),d(E.ERROR))})()}),[u,c,i]),(0,s.useEffect)((()=>{c!==u&&u===E.POSTED&&((0,ve.Z)({event:"review_posted"}),r(v))})),(0,s.useEffect)((()=>{c!==u&&u===E.UPLOADING_PHOTOS&&(l?(async()=>{x()(l,"only upload photos if config is defined");const e=await l.onUploadPhotos();d(e?E.POSTING_REVIEW:E.ERROR)})():d(E.POSTING_REVIEW))}),[l,u,c]),(0,s.useEffect)((()=>{u===E.AUTHENTICATING&&n&&!f&&d(E.UPLOADING_PHOTOS)}),[u,c,n,f]),{postStatus:u,formError:g,showPostingConfirmationModal:w,showSignupModal:y,onSubmit:()=>{u!==E.DRAFTING&&u!==E.ERROR||(e?t?(p(null),n?l&&l.numFailedPhotoUploads>0?m(!0):d(E.UPLOADING_PHOTOS):(d(E.AUTHENTICATING),b(!0))):p((0,a.ag)("To submit your review, please explain your rating to others.")):p((0,a.ag)("To submit your review, please select a star rating for this business.")))},onCloseSignupModal:()=>{b(!1),d(E.DRAFTING)},onFinishSignup:()=>{b(!1),o()},onClosePostingConfirmation:()=>{m(!1)},onPostConfirm:()=>{m(!1),d(E.POSTING_REVIEW),p(null)}}};var fe="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),we=new Uint8Array(16);function me(){if(!fe)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return fe(we)}for(var ye=[],be=0;be<256;++be)ye[be]=(be+256).toString(16).substr(1);const Ee=function(e,t){var n=t||0,s=ye;return[s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]]].join("")};const je=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||me)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var r=0;r<16;++r)t[s+r]=i[r];return t||Ee(i)};var Te=n(27610);const Se=Object.freeze({CREATE:"create",EDIT:"edit",UPDATE:"update"}),Re=({businessEncid:e,writingState:t,reviewOrigin:n,suggestionUUID:i})=>{const[r,o]=(0,s.useState)(null),a=(0,s.useContext)(Te.p7);return{onStartSession:()=>{if(!r&&a instanceof Te.NT){const s=je();let r;o(s),r=t===T.EDITING?Se.EDIT:t===T.UPDATING?Se.UPDATE:Se.CREATE,((e,t,n,s,i,r)=>{e.logEvent(["contributions.review_session","review_session_start","1.0"],{review_session_id:t,suggestion_uuid:n??null,origin:s,business_id_encid:i,update_type:r})})(a,s,i,n,e,r)}},reviewSessionId:r}},_e=({writingState:e,isLoggedIn:t,text:n,rating:i,timeVisited:r,onSaveDraftRequest:o})=>{const[a,l]=(0,s.useState)(j.NONE),u=(0,he.D9)(n)??n,d=(0,he.D9)(i)??i,c=(0,he.D9)(r)??r,[g]=(0,ae.Z)((async()=>{l(j.IN_PROGRESS);const{success:e}=await o();l(e?j.SAVED:j.FAILURE)}),500),p=t&&e!==T.EDITING;return(0,s.useEffect)((()=>{p&&u!==n&&(l(j.USER_INPUT),g())}),[p,u,n,g]),(0,s.useEffect)((()=>{p&&d!==i&&(l(j.USER_INPUT),g())}),[p,d,i,g]),(0,s.useEffect)((()=>{p&&c!==r&&(l(j.USER_INPUT),g())}),[p,c,r,g]),(0,s.useEffect)((()=>{p&&e===T.NEW_REVIEW&&i&&(l(j.USER_INPUT),g())}),[]),{saveDraftStatus:a}},Ie=({businessEncid:e,writingState:t,isLoggedIn:n,reviewData:i,reviewOrigin:r,locale:o,csrfTokens:u,onAuth:d,onCompleteReview:c})=>{const{text:g,rating:p}=i,[h,f]=(0,s.useState)(g),[w,y]=(0,s.useState)(p),{onStartSession:b,reviewSessionId:j}=Re({businessEncid:e,writingState:t,reviewOrigin:r}),{postStatus:S,formError:R,showSignupModal:_,onSubmit:P,onCloseSignupModal:k,onFinishSignup:C}=xe({reviewText:h,reviewRating:w,isLoggedIn:n,onPostReviewRequest:async()=>t===T.EDITING?(async()=>{const t=i.encid;let n;x()(t,"Must have defined review id if editing a review");try{const s=await fetch("/writeareview/v2/review_edit",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:(0,O.Z)({business_id:e,review_id:t,rating:w,review_origin:r,review_session_id:j,text:h,csrftok:u.reviewEdit})});if(!s.ok)throw new Error(`Review edit request error status: ${s.status}: ${s.statusText}`);n=await s.json()}catch(e){I(e)}return n?n.success?{success:!0,reviewEncid:t}:{success:!1,errorMessage:n.message}:{success:!1,errorMessage:(0,a.ag)("Oops! Something went wrong. Please try again in a bit.")}})():(async()=>{let t;try{const n=await fetch("/writeareview/v2/review_post",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:(0,O.Z)({business_id:e,rating:w,review_origin:r,review_session_id:j,text:h,tweet_text:(0,a.ag)("My review on #Yelp"),csrftok:u.reviewPost})});if(!n.ok)throw new Error(`Review post error status: ${n.status}: ${n.statusText}`);t=await n.json()}catch(e){I(e)}return t?t.success?{success:!0,reviewEncid:t.review.id}:"UNCONFIRMED_AND_REVIEWED"===t.code?{success:!0,reviewEncid:null}:{success:!1,errorMessage:t.message}:{success:!1,errorMessage:(0,a.ag)("Oops! Something went wrong. Please try again in a bit.")}})(),onFinishPosting:e=>{x()(0!==w,"Review rating must be selected to post a review"),c({encid:e,text:h,rating:w})},onAuth:d}),{saveDraftStatus:D}=_e({writingState:t,isLoggedIn:n,text:h,rating:w,onSaveDraftRequest:async()=>{let t;try{const n=await fetch(`/writeareview/v2/save_draft/${e}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=utf-8","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:(0,O.Z)({csrftok:u.saveDraft,rating:w,comment:h,review_origin:r})});if(!n.ok)throw new Error(`Save draft error status: ${n.status}: ${n.statusText}`);t=await n.json()}catch(e){I(e)}return{success:Boolean(t&&t.success)}}});return(0,m.jsx)(l.W2,null,(0,m.jsx)(A.Z,{onSubmit:e=>{e.preventDefault(),P()},"data-testid":"form"},(0,m.jsx)(l.W2,null,(0,m.jsx)(pe,{businessEncid:e,saveDraftStatus:D,text:h,rating:w,inputError:R,onTextChange:e=>{b(),f(e)},onRatingChange:e=>{b(),y(e)}})),(0,m.jsx)(l.W2,{marginTop:2},(0,m.jsx)(v.zx,{type:"primary",size:"standard",testId:"post-button",isLoading:S===E.POSTED||S===E.POSTING_REVIEW||S===E.UPLOADING_PHOTOS||S===E.POSTED,text:t===T.COMPLETING_DRAFT?(0,a.ag)("Finish draft"):(0,a.ag)("Post review")}))),(0,m.jsx)(N.Z,{initialScreen:"signup",locale:o,onClose:k,visible:_,onLogin:C,onSignup:C,showFacebookContinueAs:!0,showGoogleOneTap:!0}))};var Pe=n(703046);function ke(){return(ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}const Ce=731,De={ry:"3",rx:"3"},Ue=20,Ae=({uniqueKey:e})=>(0,m.jsx)(l.W2,{shadowType:"inline",padding:2},(0,m.jsx)(Pe.ZP,{width:Ce,height:320,uniquekey:e},(0,m.jsx)("rect",{x:0,y:0,width:64,height:64,rx:64,ry:64}),(0,m.jsx)("rect",ke({x:76,y:0,height:Ue,width:130},De)),(0,m.jsx)("rect",ke({x:76,y:26,height:18,width:80},De)),(0,m.jsx)("rect",ke({x:76,y:50,height:18,width:110},De)),(0,m.jsx)("rect",ke({x:571,y:50,width:160,height:18},De)),(0,m.jsx)("rect",ke({x:0,y:100,width:165,height:32},De)),(0,m.jsx)("rect",ke({x:173,y:105,width:100,height:Ue},De)),(0,m.jsx)("rect",ke({x:0,y:148,width:Ce,height:Ue},De)),(0,m.jsx)("rect",ke({x:0,y:174,width:Ce,height:Ue},De)),(0,m.jsx)("rect",ke({x:0,y:200,width:320,height:Ue},De)),(0,m.jsx)("rect",ke({x:0,y:280,width:125,height:40},De)))),Ne=Ae,Oe=o.ZP`
    query GetWarInlineEditorLoggedInUserData($businessEncid: String!, $saveDraftUrl: String!) {
        business(encid: $businessEncid) {
            name
            alias
            reviewDraftForLoggedInUser {
                text
                rating
            }
        }
        loggedInUser {
            encid
            displayName
            displayLocation
            reviewCount
            friendCount
            currentTruncatedEliteYear
            businessPhotoCount
            profilePhoto {
                photoUrl {
                    url(size: SQUARE_MEDIUM)
                }
            }
            hasUnconfirmedReviewForBusiness(businessEncid: $businessEncid)
        }
        csrfTokenSaveDraft: csrfToken(scope: $saveDraftUrl)
        csrfTokenReviewEdit: csrfToken(scope: "/writeareview/v2/review_edit")
        csrfTokenReviewPost: csrfToken(scope: "/writeareview/v2/review_post")
        csrfTokenYnraBlockSuggestion: csrfToken(scope: "/block_review_suggestion")
        csrfTokenYnraImpression: csrfToken(scope: "/review_suggestions/suggestion_impression/1.0.0")
    }
`,We=({businessEncid:e,reviewOrigin:t,onCompleteReview:n,locale:o})=>{var g,h,f,w;const{loading:b,error:E,data:j,refetch:S}=(0,i.aM)(Oe,{variables:{businessEncid:e,saveDraftUrl:`/writeareview/v2/save_draft/${e}`}}),{loading:R,showEditor:P}=U({businessEncid:e,locale:o}),[k,C]=(0,s.useState)(!1);if((0,s.useEffect)((()=>{E&&I(p()(E))}),[E]),E)return null;if(b||R||!j)return(0,m.jsx)(Ne,{uniqueKey:"war-inline-editor-shimmer"});if(!P)return null;const D=null==j?void 0:j.loggedInUser,A=_({queryReviewId:null,business:null==j?void 0:j.business,loggedInUser:D}),N={src:D?null===(g=D.profilePhoto)||void 0===g||null===(h=g.photoUrl)||void 0===h?void 0:h.url:null,srcSet:D?null===(f=D.profilePhoto)||void 0===f||null===(w=f.photoUrl)||void 0===w?void 0:w.url:null,markupDisplayName:D?D.displayName:"Username",secondaryText:D?D.displayLocation:"Location",link:D?`/user_details?userid=${D.encid}`:null,userUrl:D?`/user_details?userid=${D.encid}`:null,partnerAlias:null,friendCount:D?D.friendCount:0,photoCount:D?D.businessPhotoCount:0,reviewCount:D?D.reviewCount:0,eliteYear:D?D.currentTruncatedEliteYear:null};let O;O=A===T.COMPLETING_DRAFT?{rating:j.business.reviewDraftForLoggedInUser.rating,text:j.business.reviewDraftForLoggedInUser.text}:{rating:0,text:""};const W={saveDraft:j.csrfTokenSaveDraft,reviewEdit:j.csrfTokenReviewEdit,reviewPost:j.csrfTokenReviewPost};return(0,m.jsx)(r.dv,null,(0,m.jsx)(l.W2,{shadowType:"inline",padding:2},(0,m.jsx)(l.W2,{marginBottom:2,borderBottom:!0,paddingBottom:2},(0,m.jsx)(c.gg,{verticalAlign:"bottom",gutter:0},(0,m.jsx)(c.ey,null,(0,m.jsx)(d.LW,N)),(0,m.jsx)(c.ey,null,(0,m.jsx)(u.xv,{align:"right"},(0,m.jsx)(v.zx,{type:"link",text:(0,a.ag)("Read our review guidelines"),onClick:()=>{C(!0)}}))))),(0,m.jsx)(Ie,{businessEncid:e,writingState:A,isLoggedIn:Boolean(D),reviewOrigin:t,reviewData:O,locale:"en_US",csrfTokens:W,onAuth:()=>{S()},onCompleteReview:({encid:t,text:s,rating:i})=>{x()(D,"Must be logged in to post a review."),n({encid:t,text:s,rating:i,userEncid:D.encid,businessEncid:e,businessName:j.business.name,businessAlias:j.business.alias,userPassport:{...N,reviewCount:D.reviewCount+1}})}})),k&&(0,m.jsx)(y,{locale:o,onClose:()=>{C(!1)}}))}},361270:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(87363);function i(e,t,n){void 0===n&&(n={});var i=n.maxWait,r=(0,s.useRef)(null),o=(0,s.useRef)([]),a=n.leading,l=void 0===n.trailing||n.trailing,u=(0,s.useRef)(!1),d=(0,s.useRef)(null),c=(0,s.useRef)(!1),g=(0,s.useRef)(e);g.current=e;var p=(0,s.useCallback)((function(){clearTimeout(d.current),clearTimeout(r.current),r.current=null,o.current=[],d.current=null,u.current=!1}),[]);(0,s.useEffect)((function(){return c.current=!1,function(){c.current=!0}}),[]);var v=(0,s.useCallback)((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];o.current=e,clearTimeout(d.current),u.current&&(u.current=!1),d.current||!a||u.current||(g.current.apply(g,e),u.current=!0),d.current=setTimeout((function(){var t=!0;a&&u.current&&(t=!1),p(),!c.current&&l&&t&&g.current.apply(g,e)}),t),i&&!r.current&&l&&(r.current=setTimeout((function(){var e=o.current;p(),c.current||g.current.apply(null,e)}),i))}),[i,t,p,a,l]),h=(0,s.useCallback)((function(){d.current&&(g.current.apply(null,o.current),p())}),[p]);return[v,p,h]}}}]);
//# sourceMappingURL=module_yelp-frontend_shared-372b1ca641dee6b7f9a962928f7aeb6528805dd0.yji-d71fccc733a3423b9f1e.js.map